name: CI
# Control when action will run

on:
  #Trigger the flow

  push:
    branches: [ master ]

    #Allows you to run workflows manually from action tab

  workflow_dispatch:
  #Made up of one or more jobs that can run sequentially in parrallel

jobs:
  #Contains a single job called "build"
  lint:
    #The type of runner the job will run
    runs-on: ubuntu-latest

    #Steps rep sequence of task
    steps:
      #checks out repository under $GITHUB_WORKSPACE, so you can access it
      - name: Checkout the code
        uses: actions/checkout@v2

      #update java version
      - name: Set Up JDK
        uses: action/setup-java@v2
        with:
          distribution: 'adopt'
          java-version: '17'

      - name: Run lint
        run: echo Run Lint

  #Unit test
  unit-test:
    needs: [ lint ]
    runs-on: ubuntu-latest
    steps:
      - name: Checkout the code
        uses: actions/checkout@v2

        #Update java version
      - name: Set Up JDK 17
        uses: actions/checkout@v2
        with:
          distribution: 'adopt'
          java-version: '17'

      - name: Run unit-test
        run: echo Run unit-test

  #Instrumentation test
  instrumentation-test:
    needs: [ unit-test ]

    #We run on mac since it requires emulator
    runs-on: macos-latest
    steps:
      - name: Checkout the code
        uses: actions/checkout@v2

        #Update java version
      - name: Set Up JDK 17
        uses: actions/setup-java@v2
        with:
          distribution: 'adopt'
          java-version: '17'

      - name: Run instrumentation-test
        run: echo instrumentation-test